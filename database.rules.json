{
  ".read": "true",
  ".write": "false",
  "users": {
    ".indexOn": "username",
    "$userID": {
      ".write": "$userID === auth.uid",
      ".validate": "newData.hasChildren(['email','username'])",
      "lastSeen": {
        ".validate": "newData.val() <= now"
      },
      "createdAt": {
        ".validate": "newData.val() <= now"
      },
      "updatedAt": {
        ".validate": "newData.val() <= now"
      }
    }
  },
  "user-feeds": {
    "$userID": {
      ".write": "$userID === auth.uid",
      "$postID": {
        ".write": "root.child('posts').child($postID).child('author').val() === auth.uid && root.child('user-following').child($userID).hasChild(auth.uid)"
      }
    }
  },
  "user-followers": {
    "$userID": {
      ".write": "$userID !== auth.uid",
      "$userID": {
        ".write": "$userID === auth.uid"
      }
    }
  },
  "user-following": {
    "$userID": {
      ".write": "$userID === auth.uid",
      "$userID": {
        ".validate": "root.child('users').hasChild($userID)"
      }
    }
  },
  "user-notifications": {
    "$userID": {
      ".write": "$userID !== auth.uid",
      "$notificationID": {
        ".write": "!data.exists() || !newData.exists()",
        ".validate": "root.child('activities').hasChild($notificationID)"
      }
    }
  },
  "user-posts": {
    "$userID": {
      ".write": "$userID === auth.uid",
      "$postID": {
        ".write": "root.child('posts').child($postID).child('author').val() === auth.uid"
      }
    }
  },
  "activities": {
    ".indexOn": "post",
    "$activityID":{
      ".write": "newData.exists() || data.exists()",
      ".validate": "newData.hasChild('author')",
      "unopened": {
        ".write": "auth.uid !== null"
      }
    }
  },
  "posts": {
    ".indexOn": "author",
    "$postID": {
      ".write": "newData.child('author').val() === auth.uid || data.child('author').val() === auth.uid",
      ".validate": "newData.hasChildren(['author','caption'])",
      "caption": {
        ".validate": "newData.isString()"
      },
      "createdAt": {
        ".validate": "newData.val() <= now"
      },
      "updatedAt": {
        ".validate": "newData.val() <= now"
      }
    }
  },
  "post-comments": {
    "$postID": {
      ".write": "root.child('posts').child($postID).child('author').val() === auth.uid",
      "$commentID": {
        ".write": "newData.child('author').val() === auth.uid || data.child('author').val() === auth.uid",
        ".validate": "newData.hasChildren(['text','author'])",
        "author": {
          ".validate": "newData.val() === auth.uid"
        },
        "text": {
          ".validate": "newData.isString()"
        },
        "createdAt": {
          ".validate": "newData.val() <= now"
        }
      }
    }
  },
  "post-likes": {
    "$postID": {
      ".write": "root.child('posts').child($postID).child('author').val() === auth.uid",
      "$userID": {
        ".write": "$userID === auth.uid"
      }
    }
  },
  "post-tagged-users": {
    "$postID": {
      ".write": "root.child('posts').child($postID).child('author').val() === auth.uid || data.exists()",
      "$userID": {
        ".validate": "$userID !== auth.uid"
      }
    }
  }
}